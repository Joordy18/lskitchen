(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[139],{69:(e,t,r)=>{"use strict";r.d(t,{supabase:()=>s});let s=(0,r(5647).UU)("https://uqyilcwzosapypgcchka.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVxeWlsY3d6b3NhcHlwZ2NjaGthIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMzNDc1MTAsImV4cCI6MjA2ODkyMzUxMH0.e9ollbywpv3ZH7laJVENWbkY8wNSs66N5rHg4wchvts",{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}})},285:(e,t,r)=>{"use strict";r.d(t,{$:()=>d});var s=r(5155),a=r(2115),i=r(9708),n=r(2085),l=r(9434);let c=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:r,variant:a,size:n,asChild:d=!1,...o}=e,u=d?i.DX:"button";return(0,s.jsx)(u,{className:(0,l.cn)(c({variant:a,size:n,className:r})),ref:t,...o})});d.displayName="Button"},802:(e,t,r)=>{Promise.resolve().then(r.bind(r,3775))},1383:(e,t,r)=>{"use strict";function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return"string"!=typeof e?"":e.trim().slice(0,t).replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").replace(/data:/gi,"")}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;if("string"!=typeof e)return{isValid:!1,error:"Input must be text"};let s=e.trim();if(s.length<t)return{isValid:!1,error:"Text must be at least ".concat(t," characters")};if(s.length>r)return{isValid:!1,error:"Text must be less than ".concat(r," characters")};for(let t of[/<script/i,/javascript:/i,/on\w+=/i,/data:text\/html/i])if(t.test(e))return{isValid:!1,error:"Invalid characters detected"};return{isValid:!0}}r.d(t,{jZ:()=>s,kb:()=>a,v$:()=>i});class i{canAttempt(e){let t=Date.now(),r=(this.attempts.get(e)||[]).filter(e=>t-e<this.windowMs);return!(r.length>=this.maxAttempts)&&(r.push(t),this.attempts.set(e,r),!0)}reset(e){this.attempts.delete(e)}constructor(e=5,t=6e4){this.maxAttempts=e,this.windowMs=t,this.attempts=new Map}}},1689:(e,t,r)=>{"use strict";r.d(t,{dj:()=>u});var s=r(2115);let a=0,i=new Map,n=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},l=[],c={toasts:[]};function d(e){c=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?n(r):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(c,e),l.forEach(e=>{e(c)})}function o(e){let{...t}=e,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:r});return d({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function u(){let[e,t]=s.useState(c);return s.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:o,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},3775:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var s=r(5155),a=r(2115),i=r(5695),n=r(285),l=r(6695),c=r(6126),d=r(5494);let o=(0,r(9946).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var u=r(744),m=r(4186),h=r(7580),p=r(69),x=r(4105),f=r(1689),g=r(1383),v=r(9053);let y=new g.v$(3,6e4);function b(){var e,t,r;let g=(0,i.useSearchParams)(),[v,b]=(0,a.useState)([]),[j,N]=(0,a.useState)(!0),w=(0,i.useRouter)(),{user:A}=(0,x.A)(),{toast:k}=(0,f.dj)(),_=(null==g||null==(e=g.get("ingredients"))?void 0:e.split(","))||[],S=(null==g||null==(t=g.get("dietary"))?void 0:t.split(",").filter(Boolean))||[],E=(null==g||null==(r=g.get("allergens"))?void 0:r.split(",").filter(Boolean))||[];(0,a.useEffect)(()=>{0===v.length&&I()},[]);let I=async()=>{N(!0);try{if(!A)return void w.push("/auth");if(!y.canAttempt(A.id)){k({title:"Limite atteinte",description:"Vous g\xe9n\xe9rez trop de recettes. Veuillez attendre avant de r\xe9essayer.",variant:"destructive"}),N(!1);return}let{data:e,error:t}=await p.supabase.functions.invoke("generate-recipes",{body:{ingredients:_.filter(Boolean),dietary_restrictions:S,allergens:E,user_id:A.id}});t?(console.error("Error generating recipes:",t),k({title:"Erreur",description:"Impossible de g\xe9n\xe9rer les recettes. Veuillez r\xe9essayer.",variant:"destructive"})):(null==e?void 0:e.recipes)&&(b(e.recipes.map(e=>({...e,image_url:e.image_url||"",difficulty:["easy","medium","hard"].includes(e.difficulty)?e.difficulty:"medium"}))),await T(e.recipes))}catch(e){console.error("Error:",e),k({title:"Erreur",description:"Une erreur inattendue s'est produite",variant:"destructive"})}finally{N(!1)}},T=async e=>{try{if(!A||!e.length)return;let t=0;for(let r of e){let{error:e}=await p.supabase.from("recipes").insert({id:r.id,user_id:A.id,title:r.title,description:r.description,ingredients:r.ingredients,instructions:r.instructions,dietary_restrictions:r.dietary_restrictions,allergens:r.allergens,prep_time:r.prep_time,cook_time:r.cook_time,servings:r.servings,difficulty:r.difficulty,created_at:new Date().toISOString(),calories:r.calories,image_url:r.image_url});e?console.error("Error saving recipe:",r.title,e):t++}t>0&&console.log("Successfully saved ".concat(t," recipe(s) to database"))}catch(e){console.error("Error saving recipes to database:",e)}};return j?(0,s.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,s.jsx)(d.F,{}),(0,s.jsx)("div",{className:"max-w-6xl mx-auto py-8 px-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(o,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"G\xe9n\xe9ration de vos recettes..."}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Notre IA analyse vos ingr\xe9dients et pr\xe9f\xe9rences"})]})})]}):(0,s.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,s.jsx)(d.F,{}),(0,s.jsxs)("div",{className:"max-w-6xl mx-auto py-8 px-6",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-foreground mb-4",children:"Vos recettes personnalis\xe9es"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Ingr\xe9dients:"}),_.map(e=>(0,s.jsx)(c.E,{variant:"outline",children:e},e))]}),(S.length>0||E.length>0)&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[S.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"R\xe9gimes:"}),S.map(e=>(0,s.jsx)(c.E,{variant:"secondary",children:e},e))]}),E.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"\xc9viter:"}),E.map(e=>(0,s.jsx)(c.E,{variant:"destructive",children:e},e))]})]})]}),0===v.length?(0,s.jsx)(l.Zp,{className:"text-center py-12",children:(0,s.jsxs)(l.Wu,{children:[(0,s.jsx)(u.A,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Aucune recette trouv\xe9e"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"Nous n'avons pas pu g\xe9n\xe9rer de recettes avec ces crit\xe8res."}),(0,s.jsx)(n.$,{onClick:()=>w.push("/search"),children:"Nouvelle recherche"})]})}):(0,s.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:v.map(e=>(0,s.jsxs)(l.Zp,{className:"cursor-pointer hover:shadow-lg transition-shadow",children:[(0,s.jsxs)(l.aR,{children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,s.jsx)(l.ZB,{className:"text-xl leading-tight",children:e.title}),(0,s.jsx)(c.E,{className:(e=>{switch(e){case"easy":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"medium":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"hard":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}})(e.difficulty),children:(e=>{switch(e){case"easy":return"Facile";case"medium":return"Moyen";case"hard":return"Difficile";default:return e}})(e.difficulty)})]}),(0,s.jsx)(l.BT,{className:"line-clamp-2",children:e.description})]}),(0,s.jsxs)(l.Wu,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(m.A,{className:"h-4 w-4"}),e.prep_time+e.cook_time," min"]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(h.A,{className:"h-4 w-4"}),e.servings," pers."]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[e.calories," kcal."]})]}),e.dietary_restrictions&&e.dietary_restrictions.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mb-3",children:e.dietary_restrictions.map(e=>(0,s.jsx)(c.E,{variant:"outline",className:"text-xs",children:e},e))}),(0,s.jsx)(n.$,{className:"w-full",onClick:()=>w.push("/recipe/".concat(e.id)),children:"Voir la recette"})]})]},e.id))}),(0,s.jsx)("div",{className:"mt-8 text-center",children:(0,s.jsx)(n.$,{variant:"outline",onClick:()=>w.push("/search"),children:"Nouvelle recherche"})})]})]})}function j(){return(0,s.jsx)(v.O,{children:(0,s.jsx)(b,{})})}},4105:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,O:()=>l});var s=r(5155),a=r(2115),i=r(69);let n=(0,a.createContext)(void 0),l=e=>{let{children:t}=e,[r,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(null),[o,u]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let{data:{subscription:e}}=i.supabase.auth.onAuthStateChange((e,t)=>{var r;d(t),l(null!=(r=null==t?void 0:t.user)?r:null),u(!1)});return i.supabase.auth.getSession().then(e=>{var t;let{data:{session:r}}=e;d(r),l(null!=(t=null==r?void 0:r.user)?t:null),u(!1)}),()=>e.unsubscribe()},[]);let m=async(e,t)=>{let{error:r}=await i.supabase.auth.signInWithPassword({email:e,password:t});return{error:r}},h=async(e,t)=>{let r="".concat(window.location.origin,"/"),{error:s}=await i.supabase.auth.signUp({email:e,password:t,options:{emailRedirectTo:r}});return{error:s}},p=async()=>{await i.supabase.auth.signOut()};return(0,s.jsx)(n.Provider,{value:{user:r,session:c,loading:o,signIn:m,signUp:h,signOut:p},children:t})},c=()=>{let e=(0,a.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4186:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},5494:(e,t,r)=>{"use strict";r.d(t,{F:()=>p});var s=r(5155),a=r(6874),i=r.n(a),n=r(5695),l=r(285),c=r(4105),d=r(744),o=r(7924),u=r(9676),m=r(1007),h=r(4835);let p=()=>{let{signOut:e,user:t}=(0,c.A)(),r=(0,n.usePathname)(),a=[{path:"/",label:"Accueil",icon:d.A},{path:"/search",label:"Recherche",icon:o.A},{path:"/history",label:"Historique",icon:u.A},{path:"/profile",label:"Profil",icon:m.A}],p=async()=>{await e()};return(0,s.jsx)("nav",{className:"bg-card border-b border-border px-6 py-4",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[(0,s.jsxs)(i(),{href:"/",className:"flex items-center space-x-2",children:[(0,s.jsx)(d.A,{className:"h-8 w-8 text-primary"}),(0,s.jsx)("span",{className:"text-2xl font-bold text-primary",children:"LS Kitchen"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-6",children:[a.map(e=>{let{path:t,label:a,icon:n}=e;return(0,s.jsxs)(i(),{href:t,className:"flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ".concat(r===t?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:[(0,s.jsx)(n,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden md:inline",children:a})]},t)}),t?(0,s.jsxs)(l.$,{variant:"outline",size:"sm",onClick:p,className:"flex items-center space-x-2",children:[(0,s.jsx)(h.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden md:inline",children:"D\xe9connexion"})]}):(0,s.jsx)(l.$,{variant:"outline",size:"sm",className:"flex items-center space-x-2",children:(0,s.jsxs)(i(),{href:"/auth",children:[(0,s.jsx)(h.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden md:inline",children:"Connexion"})]})})]})]})})}},6126:(e,t,r)=>{"use strict";r.d(t,{E:()=>l});var s=r(5155);r(2115);var a=r(2085),i=r(9434);let n=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:r,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)(n({variant:r}),t),...a})}},6695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>o,ZB:()=>c,Zp:()=>n,aR:()=>l});var s=r(5155),a=r(2115),i=r(9434);let n=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});n.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",r),...a})});l.displayName="CardHeader";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});c.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...a})});d.displayName="CardDescription";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",r),...a})});o.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},7580:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},9053:(e,t,r)=>{"use strict";r.d(t,{O:()=>l});var s=r(5155),a=r(2115),i=r(5695),n=r(4105);let l=e=>{let{children:t}=e,{user:r,loading:l}=(0,n.A)(),c=(0,i.useRouter)();return((0,a.useEffect)(()=>{l||r||c.push("/auth")},[r,l,c]),l)?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):r?(0,s.jsx)(s.Fragment,{children:t}):null}},9434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>i});var s=r(2596),a=r(9688);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}}},e=>{e.O(0,[225,105,441,964,358],()=>e(e.s=802)),_N_E=e.O()}]);